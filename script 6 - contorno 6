import cv2

# Caminho do vídeo
caminho_video = r"C:\Users\Ricardo Gomes\Desktop\bolhas.mp4"

# Carregar o vídeo
video = cv2.VideoCapture(caminho_video)

# Verificar se o vídeo foi carregado corretamente
if not video.isOpened():
    print("Não foi possível carregar o vídeo. Verifique o caminho.")
else:
    while True:
        # Ler cada quadro do vídeo
        ret, frame = video.read()
        
        # Verificar se o quadro foi lido corretamente
        if not ret:
            print("Fim do vídeo ou erro ao ler o quadro.")
            break

        # Obter dimensões do quadro
        altura, largura = frame.shape[:2]

        # Converter para escala de cinza
        frame_cinza = cv2.cvtColor(frame, cv2.COLOR_BGR2GRAY)

        # Detectar contornos na imagem em escala de cinza
        contornos, _ = cv2.findContours(frame_cinza, cv2.RETR_TREE, cv2.CHAIN_APPROX_SIMPLE)

        # Criar uma imagem para desenhar os contornos
        frame_contornos = cv2.cvtColor(frame_cinza, cv2.COLOR_GRAY2BGR)

        # Desenhar contornos em verde
        for contorno in contornos:
            cv2.drawContours(frame_contornos, [contorno], -1, (0, 255, 0), 2)

        # Redimensionar o quadro para ter 500 pixels de largura
        novo_largura = 500
        nova_altura = int(altura * (novo_largura / largura))
        frame_redimensionado = cv2.resize(frame_contornos, (novo_largura, nova_altura))

        # Exibir o quadro com contornos em verde e tamanho ajustado
        cv2.imshow("Vídeo em Escala de Cinza com Contornos Verdes", frame_redimensionado)

        # Atraso no próximo quadro (1 ms para não atrasar a exibição)
        if cv2.waitKey(1) & 0xFF == ord('q'):
            break

    # Liberar o vídeo e fechar janelas
    video.release()
    cv2.destroyAllWindows()

